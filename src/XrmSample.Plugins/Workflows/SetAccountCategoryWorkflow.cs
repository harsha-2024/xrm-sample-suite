using System;using System.Activities;using Microsoft.Xrm.Sdk;using Microsoft.Xrm.Sdk.Workflow;namespace XrmSample.Plugins.Workflows{public sealed class SetAccountCategoryWorkflow:CodeActivity{[Input("Account")][ReferenceTarget("account")]public InArgument<EntityReference> AccountRef{get;set;}[Input("Category (Text)")]public InArgument<string> CategoryText{get;set;}protected override void Execute(CodeActivityContext context){var wf=context.GetExtension<IWorkflowContext>();var fac=context.GetExtension<IOrganizationServiceFactory>();var svc=fac.CreateOrganizationService(wf.UserId);var aref=AccountRef.Get(context);var cat=CategoryText.Get(context);if(aref==null)throw new InvalidWorkflowException("Account reference is required.");var account=new Entity("account",aref.Id);account["new_categorytext"]=cat;svc.Update(account);}}}