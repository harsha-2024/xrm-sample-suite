using System;using Microsoft.Xrm.Sdk;namespace XrmSample.Plugins.Plugins.CustomApi{public class CalculateDiscountCustomApi:XrmSample.Plugins.PluginBase{protected override void ExecutePlugin(IPluginExecutionContext c,IOrganizationService s,ITracingService t){if(!c.MessageName.Equals("new_CalculateDiscount",StringComparison.OrdinalIgnoreCase))return;decimal amount=0m,rate=0.10m;if(c.InputParameters.Contains("Amount")){var val=c.InputParameters["Amount"];if(val is Money m)amount=(decimal)m.Value;else if(val is decimal d)amount=d;}if(c.InputParameters.Contains("Rate")&&c.InputParameters["Rate"] is decimal r)rate=r;var discount=amount*rate;c.OutputParameters["Discount"]=new Money((decimal)discount);}}}